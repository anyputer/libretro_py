retropad_buttons = (
  5,  38,  12,  13, 154,  13,  13,  37,
  5,  35,  12,  21, 144,  13,  21,  34,
  5,  33,  12,  26, 138,  13,  26,  32,
  5,  32,  12,  28, 136,  13,  28,  31,
  5,  32,  12,  29, 134,  13,  30,  30,
  5,  31,  12,  31, 133,  13,  30,  30,
  5,  31,  12,  31, 133,  13,  30,  30,
  9,  31,  12,   2,  23,  12,   6, 133,  13,   5,  24,  13,   1,  30,
  5,  60,  12,   1, 134,  13,   1,  59,
  1, 255,
  1, 255,
  1, 255,
  5,  39,  10,  13, 152,  11,  14,  37,
  5,  34,  10,  24, 141,  11,  24,  32,
  5,  31,  10,  29, 136,  11,  29,  30,
  5,  30,  10,  31, 134,  11,  32,  28,
  5,  29,  10,  33, 133,  11,  32,  28,
  5,  29,  10,  33, 133,  11,  32,  28,
  5,  29,  10,  33, 133,  11,  32,  28,
  5,  29,  10,  33, 133,  11,  32,  28,
  5,  29,  10,  33, 133,  11,  32,  28,
  9,  29,  10,   7,  19,  10,   7, 133,  11,   7,  18,  11,   7,  28,
  9,  29,  10,   2,  29,  10,   2, 133,  11,   1,  29,  11,   2,  28,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  1, 255,
  3, 207,   9,   6,  42,
  3, 205,   9,  10,  40,
  3, 204,   9,  13,  38,
  3, 203,   9,  15,  37,
  3, 202,   9,  16,  37,
  3, 202,   9,  17,  36,
  5,  39,   4,  13, 149,   9,  18,  36,
  5,  39,   4,  13, 149,   9,  18,  36,
  5,  39,   4,  13, 149,   9,  18,  36,
  5,  39,   4,  13, 149,   9,  18,  36,
  5,  39,   4,  13, 150,   9,  17,  36,
  5,  39,   4,  13, 150,   9,  17,  36,
  5,  39,   4,  13, 151,   9,  15,  37,
  5,  39,   4,  13, 151,   9,  14,  38,
  5,  40,   4,  12, 153,   9,  11,  39,
  5,  41,   4,  10, 156,   9,   7,  41,
  3,  42,   4,   8, 205,
  3,  43,   4,   6, 206,
  7,  44,   4,   4, 139,   1,   3,  41,   8,   3,  21,
  11,  24,   6,  11,  10,   4,   2,   9,   7,  11, 117,   1,   9,  35,   8,   9,  18,
  9,  24,   6,  12,  19,   7,  12, 115,   1,  12,  33,   8,  12,  16,
  13,  24,   6,  13,  17,   7,  13,  30,   2,  14,  35,   3,  13,  22,   1,  14,  30,   8,  15,  15,
  13,  24,   6,  14,  15,   7,  14,  30,   2,  14,  34,   3,  14,  21,   1,  16,  29,   8,  16,  14,
  13,  24,   6,  15,  13,   7,  15,  30,   2,  14,  34,   3,  14,  21,   1,  17,  27,   8,  17,  14,
  13,  24,   6,  16,  11,   7,  16,  30,   2,  14,  34,   3,  14,  20,   1,  18,  27,   8,  18,  13,
  13,  24,   6,  16,  12,   7,  15,  30,   2,  14,  34,   3,  14,  20,   1,  18,  27,   8,  18,  13,
  13,  24,   6,  15,  14,   7,  14,  30,   2,  14,  34,   3,  14,  20,   1,  18,  26,   8,  19,  13,
  13,  24,   6,  14,  16,   7,  13,  30,   2,  14,  34,   3,  14,  20,   1,  18,  27,   8,  18,  13,
  9,  24,   6,  13,  18,   7,  12, 112,   1,  18,  27,   8,  17,  14,
  9,  24,   6,  12,  20,   7,  11, 113,   1,  17,  27,   8,  17,  14,
  13,  24,   6,  11,  10,   5,   1,  11,   7,  10,  57,  16,   8,  48,   1,  16,  29,   8,  16,  14,
  9,  44,   5,   3,  75,  16,  12,  47,   1,  14,  31,   8,  14,  15,
  9,  43,   5,   5,  73,  16,  14,  47,   1,  12,  33,   8,  12,  16,
  9,  42,   5,   7,  71,  16,  16,  48,   1,   9,  35,   8,   9,  18,
  5,  41,   5,   9,  70,  16,  16, 119,
  5,  40,   5,  11,  68,  16,  18, 118,
  7,  39,   5,  13,  67,  16,  18,  70,   0,   7,  41,
  7,  39,   5,  13,  67,  16,  18,  68,   0,  11,  39,
  7,  39,   5,  13,  67,  16,  18,  67,   0,  13,  38,
  7,  39,   5,  13,  67,  16,  18,  66,   0,  15,  37,
  7,  39,   5,  13,  67,  16,  17,  66,   0,  17,  36,
  7,  39,   5,  13,  68,  16,  16,  66,   0,  17,  36,
  7,  39,   5,  13,  68,  16,  15,  66,   0,  18,  36,
  7,  39,   5,  13,  69,  16,  13,  67,   0,  18,  36,
  5, 123,  16,  10,  68,   0,  18,  36,
  5, 125,  16,   5,  71,   0,  18,  36,
  3, 202,   0,  17,  36,
  7,  82,  14,   9,  75,  15,   8,  28,   0,  17,  36,
  7,  79,  14,  15,  69,  15,  14,  26,   0,  15,  37,
  7,  77,  14,  19,  65,  15,  18,  25,   0,  13,  38,
  7,  76,  14,  21,  62,  15,  22,  24,   0,  11,  39,
  7,  75,  14,  23,  60,  15,  24,  25,   0,   7,  41,
  5,  74,  14,  25,  58,  15,  26,  72,
  5,  73,  14,  27,  56,  15,  28,  71,
  5,  72,  14,  29,  55,  15,  28,  71,
  5,  71,  14,  31,  53,  15,  30,  70,
  5,  71,  14,  31,  52,  15,  32,  69,
  5,  70,  14,  33,  51,  15,  32,  69,
  5,  70,  14,  33,  50,  15,  34,  68,
  5,  70,  14,  33,  50,  15,  34,  68,
  5,  69,  14,  35,  49,  15,  34,  68,
  5,  69,  14,  35,  49,  15,  34,  68,
  5,  69,  14,  35,  49,  15,  34,  68,
  5,  69,  14,  35,  48,  15,  36,  67,
  5,  69,  14,  35,  48,  15,  36,  67,
  5,  69,  14,  35,  48,  15,  36,  67,
  5,  69,  14,  35,  49,  15,  34,  68,
  5,  69,  14,  35,  49,  15,  34,  68,
  5,  69,  14,  35,  49,  15,  34,  68,
  5,  70,  14,  33,  50,  15,  34,  68,
  5,  70,  14,  33,  50,  15,  34,  68,
  5,  70,  14,  33,  51,  15,  32,  69,
  5,  71,  14,  31,  52,  15,  32,  69,
  5,  71,  14,  31,  53,  15,  30,  70,
  5,  72,  14,  29,  55,  15,  28,  71,
  5,  73,  14,  27,  56,  15,  28,  71,
  5,  74,  14,  25,  58,  15,  26,  72,
  5,  75,  14,  23,  60,  15,  24,  73,
  5,  76,  14,  21,  62,  15,  22,  74,
  5,  77,  14,  19,  65,  15,  18,  76,
  5,  79,  14,  15,  69,  15,  14,  78,
  5,  82,  14,   9,  75,  15,   8,  81,
  1, 255,
  1, 255,
  1, 255
)

def retro_run(frame_buf, width, height, input_state):
  pixel = 49 * width + 32
  rle = 0

  while rle < len(retropad_buttons):
    paint = False
    runs = retropad_buttons[rle]
    rle += 1

    while runs > 0:
      if paint:
        button = 1 << retropad_buttons[rle]
        rle += 1
        count = retropad_buttons[rle]
        rle += 1
        color = 0x0500 if (input_state & button) else 0xffff

        while count > 0:
          frame_buf[pixel] = color
          pixel += 1
          count -= 1
      else:
        pixel += retropad_buttons[rle]
        rle += 1

      paint = not paint
      runs -= 1

    pixel += 65

